<!-- Generated on 2015-04-20 by meteor-stock. Edit me! -->
<template name="postsList">
	<div class="container">

            <h2>Posts List <button type="button" class="btn btn-sm btn-info" data-toggle="popover" title="Popover title"
                                  data-content="And here's some amazing content. It's very engaging. Right?">Click to toggle popover</button>
            </h2>




			{{#each posts}}
				{{> Post}}
			{{/each}}
			{{> newPost}}
	</div>
</template>

<template name="Post">
	<div style="border: 1px solid orange">
		<h4 class="editable-text-trigger">	
			{{> editableText collection="posts" field="message" placeholder="Post message" removeEmpty=true wysiwyg=true beforeUpdate="whoDunnitPosts" beforeInsert="whoDunnitPosts" substitute='<i class="fa fa-pencil"></i>'}}
		</h4>
		<!--{{#if imagePath.url}}
			<img class="bulletin-image" src={{imagePath.url}}>
		{{#else}}
			{{> uploader}}	 TODO: conditional on editing text
		{{/if}}
		-->
		<div class="row" style="font-size: 10px">
			<div class="col-md-2"> author: {{getEmail authorId}} </div>
			<div class="col-md-4"> last edited: {{lastEdited}} </div>
			<div class="col-md-2"> last editor: {{getEmail authorId}} </div>
			<div class="col-md-1"> pinned: {{pinned}} </div>
			<div class="col-md-3"> image: {{imagePath.url}} </div>
		</div>
	</div>
</template>

<template name="uploader">
	<div class="row">
		<div class="col-md-8">	{{> upload_bootstrap fileTypes='.jpg'
		multiple=false callbacks=myCallbacks}}
		</div>
		{{#if imagePath.url}}
			<div class="col-md-4">
					<span class="btn btn-warning clear" post="{{_id}}">Remove Image</span>
			</div>
		{{/if}}
	</div>
</template>

<template name="newPost">

	<span class="btn btn-info editable-text-trigger">
		<i class="fa fa-plus"></i> New post{{> editableText context=newPosts
		collection="posts" field="message" autoInsert=true}}
	</span>

</template>